# 快速启动指南: 前端UI与AI功能优化

**功能分支**: `004-ui-and-ai-enhancements`
**创建时间**: 2025-12-15

## 前提条件

- 已完成 003-highlight-interaction 功能的实现
- Chrome 88+ 或 Edge 88+ 浏览器
- 扩展已加载到浏览器
- （可选）OpenRouter 账号和 API key

## 功能验证步骤

### 步骤 1: 测试选择浮窗透明度 (US1)

1. 访问任意包含文章内容的网页
2. 选中一段文本
3. **预期**: 出现的标记浮窗背景呈半透明效果，可以隐约看到底层内容
4. **预期**: 浮窗中的按钮图标清晰可见，易于点击

### 步骤 2: 测试笔记编辑浮窗 (US2)

1. 选中一段文本，等待标记浮窗出现
2. 点击"笔记"按钮（📝 图标）
3. **预期**: 出现自定义的笔记编辑浮窗（与点击高亮后的编辑器样式一致）
4. 在编辑器中输入笔记内容
5. 点击"保存"按钮
6. **预期**: 创建带笔记的高亮，编辑浮窗关闭
7. 悬停到新创建的高亮上
8. **预期**: 显示笔记内容浮窗

### 步骤 3: 测试笔记编辑浮窗取消 (US2)

1. 选中一段文本，点击"笔记"按钮
2. 在编辑器中输入一些内容
3. 点击"取消"按钮或按 Escape 键
4. **预期**: 编辑浮窗关闭，不创建高亮

### 步骤 4: 测试 OpenRouter 配置 (US3)

1. 点击扩展图标，打开 popup
2. 点击设置按钮，进入设置页面
3. 在 AI Provider 下拉菜单中选择 "OpenRouter"
4. **预期**: 显示 API Key 输入框和 Model 输入框
5. 输入 OpenRouter API Key
6. 输入模型名称（如 "openai/gpt-4o"）
7. 点击保存
8. **预期**: 设置保存成功，显示成功提示

### 步骤 5: 测试自定义 Prompt (US4)

1. 在设置页面找到 "AI Summary Prompt" 区域
2. **预期**: 显示当前生效的 prompt（首次为默认 prompt）
3. 修改 prompt 内容
4. 点击保存
5. **预期**: 设置保存成功
6. 刷新设置页面
7. **预期**: 显示之前保存的自定义 prompt

### 步骤 6: 测试恢复默认 Prompt (US4)

1. 在设置页面的 prompt 区域
2. 点击"恢复默认"按钮
3. **预期**: prompt 内容恢复为系统默认值
4. 点击保存
5. **预期**: 设置保存成功

### 步骤 7: 边界情况测试

| 测试场景 | 操作 | 预期结果 |
|----------|------|----------|
| 空模型名称 | OpenRouter 模型名称留空并保存 | 显示错误提示，不允许保存 |
| 空 prompt | 清空 prompt 内容并保存 | 自动使用默认 prompt |
| 长 prompt | 输入超过 2000 字符的 prompt | 显示字符限制提示 |
| 无效模型格式 | 输入 "gpt-4o"（缺少 provider/）| 显示格式错误提示 |

## 性能验证

- 选择浮窗显示延迟: < 100ms
- 笔记编辑器显示延迟: < 100ms
- 设置保存延迟: < 500ms
- 无 UI 卡顿或闪烁

## 验收检查清单

### 选择浮窗透明度 (US1)
- [ ] 浮窗背景呈半透明效果
- [ ] 可以隐约看到底层内容
- [ ] 按钮和文字清晰可读
- [ ] 不影响操作体验

### 笔记编辑浮窗 (US2)
- [ ] 点击笔记按钮弹出自定义编辑器
- [ ] 编辑器样式与点击高亮的编辑器一致
- [ ] 保存按钮创建带笔记的高亮
- [ ] 取消按钮关闭编辑器不创建高亮
- [ ] Escape 快捷键工作正常
- [ ] Enter 快捷键保存工作正常

### OpenRouter 配置 (US3)
- [ ] AI Provider 下拉菜单包含 OpenRouter 选项
- [ ] 选择 OpenRouter 后显示模型输入框
- [ ] API Key 和模型配置可保存
- [ ] 配置保存后刷新页面不丢失
- [ ] 模型名称格式验证工作正常

### 自定义 Prompt (US4)
- [ ] 设置页面显示当前 prompt
- [ ] 可编辑和保存自定义 prompt
- [ ] "恢复默认"按钮工作正常
- [ ] 空 prompt 自动使用默认值
- [ ] 字符限制提示工作正常
